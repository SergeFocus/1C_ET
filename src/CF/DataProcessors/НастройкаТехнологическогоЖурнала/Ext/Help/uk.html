<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.17126"></meta></head><body>
<h1>Налаштування файлу конфігурації технологічного журналу (logcfg.xml)</h1>
<dl><dt>Дана обробка призначена для редагування файлу конфігурації технологічного журналу (<strong>logcfg.xml</strong>).</dt></dl><p class="Important">Можливості даної обробки не дозволяють повністю використовувати можливості, що надаються форматом цього файлу в частині налаштувань подій, що реєструються в технологічному журналі, однак, наданих можливостей достатньо для швидкого створення конфігураційних файлів, що закривають значну частину потреб.</p>
<p>При відкритті обробка виконує спробу відкрити існуючий файл конфігурації технологічного журналу. Пошук файлу виконується за наступними шляхами:</p>
<ul><li>Каталог <strong>bin \ conf</strong>
 запущеної версії 1С: Підприємства 8. Якщо файл виявлений - він відкривається обробкою і подальший пошук пркращаются. </li><li>Якщо файл не виявлений і в каталозі <strong>bin \ conf</strong> розташований файл <strong>conf.cfg</strong>, То проводиться спроба знайти файл в каталозі, зазначеного в цьому файлі. Якщо файл знайдений - він відкривається обробкою.</li></ul><p>За допомогою даної обробки можна вказувати параметри формування дампа, контролю витоків пам'яті і параметри технологічного журналу.</p>
<p>На закладці <strong class="ControlElement">Налаштування технологічного журналу</strong> можна завалу параметри формування технологічного журналу.</p>
<p>На закладці <strong class="ControlElement">Налаштування дампа і відстеження витоків пам'яті</strong> є можливість задавати параметри:</p>
<ul><li>
Створення дампів пам'яті; </li><li>
Фіксації витоків пам'яті на сервері; </li><li>Фіксації витоків пам'яті в конфігурації.</li></ul><p>На закладці <strong>Технологічний журнал за замовчуванням і системні події</strong> виконується настройка параметрів формування технологічного журналу за замовчуванням.</p>
<p>Також є можливість формувати шаблони файлів конфігурації.</p>
<p>Для цього необхідно задати необхідні параметри файлу конфігурації і виконати команду <strong>Ще - Зберегти як шаблон ...</strong> Файл конфігурації буде збережений в каталог загальних конфігураційних файлів з ім'ям <strong>config * .lct </strong>(замість символу * буде підставлений порядковий номер файлу шаблону).</p>
<h2>Робота з редактором параметрів технологічного журналу</h2>
<p>Розглянемо прийоми роботи з редактором параметрів технологічного журналу.</p>
<h3>Налаштування параметрів редактора технологічного журналу</h3>
<p>Над редактором розташовується група параметрів <strong>Налаштування</strong>. У цій групі задаються необхідність ведення технологічного журналу, місце його розташування і час зберігання, а також параметри, які дозволяють зробити процес редагування зручним. Групу можна згорнути, після того, як виконані всі налаштування, щоб вона займала менше місця на екрані.</p>
<p>Прапорець <strong>Формувати технологічний журнал</strong> управляє необхідністю створення технологічного журналу системою "1С: Підприємства". </p>
<p><strong>Місцезнаходження технологічного журналу</strong> і <strong>Період зберігання історії, годинник</strong> визначають де і як довго буде зберігатися технологічний журнал.</p>
<p>У правій частині групи настройок розташовуються допоміжні елементи управління, які дозволяють зробити процес редагування зручним. Група перемикачів (<strong class="ControlElement">Всі властивості</strong>,<strong class="ControlElement">Тільки вибрані властивості</strong> і <strong class="ControlElement">Всі властивості обраних подій</strong>) Визначає, які події будуть відображатися у вікні редактора:</p>
<ul><li>
<div><strong>Всі властивості обраних подій</strong> - Це динамічний режим. При цьому відображаються тільки ті властивості, які доступні для обраних подій (відзначена сама перша колонка). Додаючи або прибираючи події - варіюється склад відображуваних властивостей. При відображенні ігнорується той факт, що для невідмічений колонки може бути задано яку-небудь властивість.</div>
</li><li>
<div>
<div><strong>Тільки вибрані властивості</strong> - В цьому випадку будуть відображатися тільки ті властивості, для яких встановлено відмітку хоча-б в одній події технологічного журналу. Режим не є динамічним.</div></div>
</li><li>
<div>
<div><strong>Всі властивості</strong> - В цьому випадку будуть відображатися всі властивості всіх подій технологічного журналу. Режим не є динамічним.</div></div></li></ul><p>Якщо потрібно відобразити тільки ті події, які будь-яким чином обрані (позначкою в будь колонці конкретної події), то зробити це можна за допомогою прапорця <strong class="ControlElement">Тільки відмічені події</strong>.</p>
<p>За допомогою перемикачів <strong>Відображати опису</strong> і <strong>Відображати імена</strong> можна управляти способом відображення властивостей і подій в редакторі.</p>
<dl><dt>
<div>Також, в нижній частині форми отображаемтся опис поточного події (група <strong>Поточне подія</strong>) І поточного властивості (група <strong>Поточне властивість</strong>). Ідентифікатор поточного події або властивості відображається в дужках після соотвествующего тексту. Наприклад, для події "SQL, Microsoft SQL Server" заголовок групи буде мати вигляд <strong>Поточне подія (dbmssql)</strong>. Якщо ця допоміжна інформація не потрібна, то її можна прибрати, згорнувши групу <strong>додаткова інформація</strong>.</div></dt></dl><h3>Загальні правила редагування</h3>
<p>Редактор параметрів являє собою матрицю, в рядках якої представлені події, які можуть потрапляти в технологічний журнал, а в колонках - властивості цих подій.</p>
<p>Осередки, які мають білий фон і обведені рамкою, виконують будь-які дії, якщо по них клацнути мишею. Клацання мишею по осередку викликає позначку - поява символу "V". Повторне клацання знімає позначку.</p>
<p>Якщо виконується відмітка осередки в колонці <strong class="ControlElement">Всі події</strong> або будь колонки правіше цієї колонки, то одночасно виконується відмітка також найпершої ячейки у поточного події (включення в технологічний журнал самої події). Зняття позначки не має таких особливостей.</p>
<p>Відмітка властивості для всіх подій (для яких визначено дане властивість) виконується за допомогою команди контекстного меню <strong class="ControlElement">Включити для всіх подій</strong>. Для того, щоб зняти позначки слід скористатися командою контекстного меню <strong class="ControlElement">Вимкнути для всіх подій</strong>, Стоячи в будь-якому рядку колонки з обраним властивістю.</p>
<p>Якщо необхідно призначити умова на подія, це слід робити за допомогою команди контекстного меню <strong class="ControlElement">Умова на подію ...</strong>, Перебуваючи в будь колонці обраного події. Якщо умови будуть задані, то відмітка приобрете вид "<strong>V</strong>"(Відмітка напівжирним шрифтом). Для видалення умов на подію слід або видалити всі події у вікні редактора умов, або скористатися командою контекстного меню <strong class="ControlElement">Очистити фільтр для події</strong>. При цьому відмітка збережеться, але втратить напівжирне оформлення.</p>
<p>Якщо необхідно призначити умова на властивість події, це слід робити за допомогою команди контекстного меню <strong class="ControlElement">Умова на властивість ...</strong>, Перебуваючи в осередку, яку можна редагувати (білий фон і рамка). Якщо умови будуть задані, то відмітка приобрете вид "<strong>V</strong>"(Відмітка напівжирним шрифтом). Для видалення умов на подію слід або видалити всі події у вікні редактора умов, або скористатися командою контекстного меню <strong class="ControlElement">Очистити фільтр для властивості</strong>. При цьому відмітка збережеться, але втратить напівжирне оформлення.</p>
<p>Якщо необхідно очистити всі налаштування властивостей і подій технологічного журналу, слід вибрати команду контекстного меню редакт ора <strong>Очистити параметри технологічного журналу</strong>. У випадку позитивної відповіді журнал буде налаштований на реєстрацію всіх властивостей для всіх подій. Ніякі інші параметри технологічного журналу (час життя і шлях в каталогом технологічного журнали не будуть змінені).</p>
<h3>Шаблони та їх використання</h3>
<p>Для спрощення створення файлів конфігурації в деяких типових випадках, редактор файлу конфігурації технологічного журналу містить кілька шаблонів (заздалегідь підготовлених файлів конфігурації), які дозволяють швидко виконати налаштування файлу конфігурації. Для використання шаблону слід вибрати команду <strong>Шаблон ...</strong> і у вікні вибрати потрібний шаблон.</p>
<p>Крім того, існує можливість самостійно створювати шаблони файлу конфігурації. Для цього слід задати необхідні параметри на обох закладках (<font color="#000040"><strong>Налаштування технологічного журналу</strong> і <strong>Налаштування дампа і відстеження витоків пам'яті</strong></font>) І вибрати команду <strong>Всі дії - Зберегти як шаблон ...</strong> Після завдання параметрів шаблону, відбувається збереження файлу шаблону в каталог конфігураційних файлів системи.</p>
<p>Потім ці шаблони також будуть доступні у вікні вибору шаблону при виборі команди <strong>Шаблон ...</strong></p>
<dl><dt>
<h3>Типові операції в редакторі параметрів технологічного журналу</h3></dt></dl><p>Якщо необхідно включити в технологічний журнал всі події і всі властивості подій, слід встановити позначку для події "Всі події" і властивості "Всі властивості". У файл <strong>logcfg.xml</strong> потрапляє наступний текст:</p><pre class="SyntaxDescription">&amp; lt; event &amp; gt;<br> &amp; lt; ne property = "name" value = "" / &amp; gt;<br>&amp; lt; / event &amp; gt;<br>&amp; lt; property name = "all" / &amp; gt;<br></pre>
<p>Якщо необхідно, щоб в файл завжди потрапляла конструкція <strong>&amp; lt; property name = "all" / &amp; gt;</strong>, Необхідно щоб було встановлено властивість "Всі властивості" для події "Всі події" (не включаючи саму подію).</p>
<p>Якщо необхідно включити в технологічний журнал всі події якої-небудь властивості, для цього необхідно відзначити найпершу колонку, розташовану перед обраним властивістю). Наприклад, якщо позначка стоїть перед властивістю "Microsoft SQL Server", то в файл <strong>logcfg.xml</strong> потрапить наступна текст:</p><pre class="SyntaxDescription">&amp; lt; event &amp; gt;<br> &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br>&amp; lt; / event &amp; gt;<br></pre>
<p dir="ltr">Якщо необхідно включити в технологічно журнал все властивості вибраного події, то слід зазначити властивість "Всі властивості" у необхідного події (при цьому подія буде відзначено автоматично, а всі доступні властивості даної події будуть відзначені особливим кольором фону). Наприклад, якщо колонка "Всі властивості" відзначена у властивості "SQL, Microsoft SQL Server", то в файл <strong>logcfg.xml</strong> потрапить наступний текст:</p><pre class="SyntaxDescription" dir="ltr">&amp; lt; event &amp; gt;<br> &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br>&amp; lt; / event &amp; gt;<br>&amp; lt; property name = "all" &amp; gt;<br> &amp; lt; event &amp; gt;<br>  &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br> &amp; lt; / event &amp; gt;<br>&amp; lt; / property &amp; gt;<br></pre>
<p>Якщо необхідно, щоб подія потрапляло в технологічний журнал тільки в тому випадку, якщо вполняется деяка умова, то слід викликати контекстне меню в будь колонці події і вибрати команду <strong>Умови на подію ...</strong> У вікні можна задавати необхідні умови (для завдання умов доступні тільки властивості, присутні у обраного події). У файл <strong>logcfg.xml</strong> потрапить текст, подібний наступному (подія <strong>dbmssql</strong> потрапить в технологічний журнал у випадку, якщо властивість <strong>duration</strong> більше ніж <strong>100000</strong>):</p><pre class="SyntaxDescription" dir="ltr">&amp; lt; event &amp; gt;<br> &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br> &amp; lt; gt property = "duration" value = "15000" / &amp; gt;<br>&amp; lt; / event &amp; gt;<br></pre>
<p dir="ltr">Якщо необхідно, щоб властивість потрапило в технологічний журнал для якої-небудь події лише в разі виконання деякого умови, слід в рядку необхідного події встати в колонку потрібного властивості і в контекстному меню вибрати команду <strong>Умови на властивість ...</strong> (в тому випадку, якщо дана властивість доступно для вибраного події). У вікні можна задавати умови на властивість. У файл <strong>logcfg.xml</strong> потрапить текст, подібний наступному (властивість <strong>sql</strong> події <strong>dbmssql</strong> потрапить в технологічний журнла тільки тоді, коли властивість <strong>duration</strong> події <strong>dbmssql</strong> більше <strong>150000</strong>):</p><pre class="SyntaxDescription">&amp; lt; property name = "sql" &amp; gt;<br> &amp; lt; event &amp; gt;<br>  &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br>  &amp; lt; gt property = "duration" value = "15000" / &amp; gt;<br> &amp; lt; / event &amp; gt;<br>&amp; lt; / property &amp; gt;</pre>
<p class="Usual">Якщо необхідно включити в технологічний журнал конкретне властивість для всіх подій, то слід в контекстному меню вибрати команду <strong>Включити для всіх подій</strong>. У файл <strong>logcfg.xml</strong> потрапить текст, подібний наступному:</p><pre class="SyntaxDescription">&amp; lt; property name = "dbpid" &amp; gt;<br> &amp; lt; event &amp; gt;<br>  &amp; lt; ne property = "name" value = "" / &amp; gt;<br> &amp; lt; / event &amp; gt;<br> &amp; lt; event &amp; gt;<br>  &amp; lt; eq property = "name" value = "db2" / &amp; gt;<br> &amp; lt; / event &amp; gt;<br> &amp; lt; event &amp; gt;<br>  &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br> &amp; lt; / event &amp; gt;<br> &amp; lt; event &amp; gt;<br>  &amp; lt; eq property = "name" value = "dboracle" / &amp; gt;<br> &amp; lt; / event &amp; gt;<br> &amp; lt; event &amp; gt;<br>  &amp; lt; eq property = "name" value = "dbpostgrs" / &amp; gt;<br> &amp; lt; / event &amp; gt;<br>&amp; lt; / property &amp; gt;</pre>
<h2>Робота з настройками дампа, відстеженням витоків пам'яті та збереженням планів запитів</h2>
<h3>Налаштування дампа</h3>
<p>Для того, щоб система 1С: Підприємство створював дамп пам'яті при настанні помилки, що приводить до аварійного заверщшенію роботи системи, необхідно увімкнути прапорець <strong>Створювати дамп при аварійному завершенні</strong>, Вибрати розташування файлу з дампом і його тип. У більшості випадків достатньо залишити тип дампа, встановлений за замовчуванням (або використовувати команду <strong>Оптимальний розмір дампа</strong> контекстного меню поля редагування типу дампа).</p>
<h3>Налаштування пам'яті планів запитів</h3>
<p>За збереження планів запитів в технологічному журналі відповідає прапорець <strong>Відстежувати плани запитів (&amp; lt; planSQL &amp; gt;)</strong> і властивість <strong>planSQLText</strong> подій виконання операторів SQL різних СУБД. Установка перший прапорця включає саму можливість генерації планів запитів, а включення або виключення властивості управляє доступністю інформації про плани запитів у відповідних подіях. Якщо вмикається збереження планів запитів, то рекомендується також включити запис властивості <strong>SQL</strong> для подій виконання операторів SQL різних СУБД.</p><pre class="SyntaxDescription"> &amp; lt; plansql / &amp; gt;<br> &amp; lt; log location = "C: \ v82 \ logs \" history = "48" &amp; gt;<br>  &amp; lt; event &amp; gt;<br>   &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br>  &amp; lt; / event &amp; gt;<br>  &amp; lt; property name = "plansqltext" &amp; gt;<br>   &amp; lt; event &amp; gt;<br>    &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br>   &amp; lt; / event &amp; gt;<br>  &amp; lt; / property &amp; gt;<br>  &amp; lt; property name = "sql" &amp; gt;<br>   &amp; lt; event &amp; gt;<br>    &amp; lt; eq property = "name" value = "dbmssql" / &amp; gt;<br>   &amp; lt; / event &amp; gt;<br>  &amp; lt; / property &amp; gt;<br> &amp; lt; / log &amp; gt;</pre>
<p>У даному прикладі для події виконання операторів СУБД сервера MSSQL (подія <strong>dbmssql</strong>) Включена фіксація текстів запитів на мові SQL (властивість <strong>sql</strong>) І планів виконання запитів (властивість <strong>plansqltext</strong>). Також включено збір планів виконання запитів (елемент <strong>plansql</strong>).</p>
<p class="Important">Отримання планів запитів уповільнює виконання запитів до СУБД. Для деяких СУБД уповільнення може бути суттєвим.</p>
<h3>Налаштування витоків пам'яті</h3>
<p class="Usual">За контроль витоків пам'яті відповідає два налаштування:</p>
<ul><li>
<div><strong>Відстежувати використанні пам'яті сервером</strong>. При цьому слід або включити висновок в технологічний журнал всіх подій, або окремо включити подія <strong>mem</strong> (<strong>Витік пам'яті сервера</strong>).</div>
</li><li>
<div><strong>Відстежувати витоку пам'яті в коді конфігурації</strong>. У цьому випадку необхідно вказати, в яких областях конфігурації необхідно контролліровать витоку пам'яті. Це можна виконати за допомогою прапорців <strong>Контрольна точка початку / закінчення виконання коду на клієнті</strong>,<strong>Контрольна точка початку / закінчення виконання коду на сервері</strong>, А також списки для введення інформації про контролліруемих модулях. При цьому слід або включити висновок в технологічний журнал всіх подій, або окремо включити подія <strong>leaks</strong> (<strong>Витік пам'яті</strong>).</div></li></ul><h2>Налаштування ведення технологічного журналу за замовчуванням</h2>
<p>Технологічний журнал за замовчуванням - це особливий вид технологічного журналу, призначений для запису подій, що виникають в критичних ситуаціях (з погляду системи «1С: Підприємство»). Для цього журналу створюється фіксований фільтр подій, який формує платформа і який неможливо змінити.</p>
<p>Однак, є можливість налаштувати <strong>Місцезнаходження системного технологічного журналу</strong> і <strong>Період зберігання історії, годинник</strong>. Для установки параметрів зберігання технологічного журналу за замовчуванням в значення за замовчуванням служить гіперпосилання <strong>Встановити налаштування системного технологічного журналу за замовчуванням</strong>.</p>
<p>За допомогою таблиці <strong>Системні події</strong> можна задати деталізацію записуваних подій.</p></body></html>