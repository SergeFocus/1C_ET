// sza151218-1733 
Процедура НаПечать(ТабДок, Ссылка) Экспорт
	
	ТабДок.ИмяПараметровПечати  = "ДокТендер" + СокрЛП(ИмяКомпьютера());
	ТабДок.КлючПараметровПечати = ТабДок.ИмяПараметровПечати;
	
	ТабДок.Очистить();
	
	СсылкаНаОбъектПечати = Ссылка[0];
	
	РазрядМетаданных = ""; ИмяМетаданных = "";
	ПроизвольнаяПечатнаяФорма = ОбщийМодульТекстСервер.ОпределитьПроизвольнуюПечатнуюФорму(, , СсылкаНаОбъектПечати, РазрядМетаданных, ИмяМетаданных);
	
	Если ЗначениеЗаполнено(ПроизвольнаяПечатнаяФорма) Тогда
		ТабДок = ОбщийМодульТекстСервер.СформироватьДокументПоПроизвольнойФорме(ПроизвольнаяПечатнаяФорма, , ТабДок, СсылкаНаОбъектПечати, РазрядМетаданных, ИмяМетаданных);
		
	Иначе		
		Макет = Документы.Тендеры.ПолучитьМакет("НаПечать");
		Запрос = Новый Запрос;
		Запрос.Текст =
		"ВЫБРАТЬ
		|	Тендеры.Дата,
		|	Тендеры.ДатаПоставки,
		|	Тендеры.Договор,
		|	Тендеры.Комментарий,
		|	Тендеры.НаправлениеДеятельности,
		|	Тендеры.Номер,
		|	Тендеры.Организация,
		|	Тендеры.Поставщик,
		|	Тендеры.Склад,
		|	Тендеры.Сотрудник,
		|	Тендеры.СтатусТендера,
		|	Тендеры.Товары.(
		|		НомерСтроки,
		|		Номенклатура,
		|		ЕдиницаИзмерения,
		|		Количество,
		|		ЗаказКлиента,
		|		ОСтроке
		|	),
		|	Тендеры.Предложения.(
		|		НомерСтроки,
		|		Поставщик,
		|		Договор,
		|		ДатаПоставки,
		|		Сумма,
		|		СуммаВВалюте,
		|		Валюта,
		|		Курс,
		|		Тендер,
		|		Условия,
		|		ОСтроке
		|	)
		|ИЗ
		|	Документ.Тендеры КАК Тендеры
		|ГДЕ
		|	Тендеры.Ссылка В (&Ссылка)";
		Запрос.Параметры.Вставить("Ссылка", Ссылка);
		Выборка = Запрос.Выполнить().Выбрать();
		
		ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
		Шапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьТоварыШапка = Макет.ПолучитьОбласть("ТоварыШапка");
		ОбластьТовары = Макет.ПолучитьОбласть("Товары");
		ОбластьПредложенияШапка = Макет.ПолучитьОбласть("ПредложенияШапка");
		ОбластьПредложения = Макет.ПолучитьОбласть("Предложения");
		Подвал = Макет.ПолучитьОбласть("Подвал");
		
		ТабДок.Очистить();
		
		ВставлятьРазделительСтраниц = Ложь;
		Пока Выборка.Следующий() Цикл
			Если ВставлятьРазделительСтраниц Тогда
				ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;
			
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьЗаголовок);
			ТабДок.Вывести(ОбластьЗаголовок);
			
			Шапка.Параметры.Заполнить(Выборка);
			СтруктураДополнительныПараметровМакета = ОбщийМодульСервер.ПолучитьСтруктуруДополнительныхПараметровМакетаПечати();
			Шапка.Параметры.ТекстВШапкеДокументовПриПечати   = СтруктураДополнительныПараметровМакета.ТекстВШапкеДокументовПриПечати ;
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(Шапка);
			ТабДок.Вывести(Шапка, Выборка.Уровень());
			
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьТоварыШапка);
			ТабДок.Вывести(ОбластьТоварыШапка);
			
			ВыборкаТовары = Выборка.Товары.Выбрать();
			Пока ВыборкаТовары.Следующий() Цикл
				ОбластьТовары.Параметры.Заполнить(ВыборкаТовары);
				ОбластьТовары.Параметры.НоменклатураНаименование = ОбщийМодульТекстСервер.ПолучитьОбщееНаименование(ВыборкаТовары.Номенклатура);
				ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ВыборкаТовары);
				ТабДок.Вывести(ОбластьТовары, ВыборкаТовары.Уровень());
			КонецЦикла;
			
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьПредложенияШапка);
			ТабДок.Вывести(ОбластьПредложенияШапка);
			
			ВыборкаПредложения = Выборка.Предложения.Выбрать();
			Пока ВыборкаПредложения.Следующий() Цикл
				ОбластьПредложения.Параметры.Заполнить(ВыборкаПредложения);
				ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьПредложения);
				ТабДок.Вывести(ОбластьПредложения, ВыборкаПредложения.Уровень());
			КонецЦикла;
			
			Подвал.Параметры.Заполнить(Выборка);
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(Подвал);
			ТабДок.Вывести(Подвал);
			
			ВставлятьРазделительСтраниц = Истина;
		КонецЦикла;	
	КонецЕсли;
	
КонецПроцедуры
