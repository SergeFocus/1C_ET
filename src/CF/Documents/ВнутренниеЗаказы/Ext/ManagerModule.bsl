// sza151217-2317 
Процедура Печать(ТабДок, Ссылка) Экспорт
	
	ТабДок.ИмяПараметровПечати  = "ДокВнутреннийЗаказ" + СокрЛП(ИмяКомпьютера());
	ТабДок.КлючПараметровПечати = ТабДок.ИмяПараметровПечати;
	
	ТабДок.Очистить();
	
	Дата = Ссылка[0].Дата;
	ПроизвольнаяПечатнаяФорма = ОбщийМодульТекстСервер.ОпределитьПроизвольнуюПечатнуюФорму(ПредопределенноеЗначение("Перечисление.ВидыПечатныхФорм.ВнутреннийЗаказ"), Дата);
	
	Если ЗначениеЗаполнено(ПроизвольнаяПечатнаяФорма) Тогда
		ТабДок = ОбщийМодульТекстСервер.СформироватьДокументПоПроизвольнойФорме(ПроизвольнаяПечатнаяФорма, , ТабДок, Ссылка[0], "Документы", "ВнутренниеЗаказы");
		
	Иначе		
		Макет = Документы.ВнутренниеЗаказы.ПолучитьМакет("Печать");
		Запрос = Новый Запрос;
		Запрос.Текст =
		"ВЫБРАТЬ
		|	ВнутренниеЗаказы.Выполнен,
		|	ВнутренниеЗаказы.Дата,
		|	ВнутренниеЗаказы.ДатаПоступления,
		|	ВнутренниеЗаказы.Комментарий,
		|	ВнутренниеЗаказы.Номер,
		|	ВнутренниеЗаказы.Склад,
		|	ВнутренниеЗаказы.СкладДонор,
		|	ВнутренниеЗаказы.Сотрудник,
		|	ВнутренниеЗаказы.ТовараВКоличестве,
		|	ВнутренниеЗаказы.Товары.(
		|		НомерСтроки,
		|		Номенклатура,
		|		Количество,
		|		ОСтроке
		|	)
		|ИЗ
		|	Документ.ВнутренниеЗаказы КАК ВнутренниеЗаказы
		|ГДЕ
		|	ВнутренниеЗаказы.Ссылка В (&Ссылка)";
		Запрос.Параметры.Вставить("Ссылка", Ссылка);
		Выборка = Запрос.Выполнить().Выбрать();
		
		ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
		Шапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьТоварыШапка = Макет.ПолучитьОбласть("ТоварыШапка");
		ОбластьТовары = Макет.ПолучитьОбласть("Товары");
		Подвал = Макет.ПолучитьОбласть("Подвал");
		ОбластьПодписи		= Макет.ПолучитьОбласть("Подписи");
		
		ТабДок.Очистить();
		
		ВставлятьРазделительСтраниц = Ложь;
		Пока Выборка.Следующий() Цикл
			Если ВставлятьРазделительСтраниц Тогда
				ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;
			
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьЗаголовок);
			ТабДок.Вывести(ОбластьЗаголовок);
			
			Шапка.Параметры.Заполнить(Выборка);
			СтруктураДополнительныПараметровМакета = ОбщийМодульСервер.ПолучитьСтруктуруДополнительныхПараметровМакетаПечати();
			Шапка.Параметры.ТекстВШапкеДокументовПриПечати   = СтруктураДополнительныПараметровМакета.ТекстВШапкеДокументовПриПечати ;
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(Шапка);
			ТабДок.Вывести(Шапка, Выборка.Уровень());
			
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьТоварыШапка);
			ТабДок.Вывести(ОбластьТоварыШапка);
			ВыборкаТовары = Выборка.Товары.Выбрать();
			Пока ВыборкаТовары.Следующий() Цикл
				ОбластьТовары.Параметры.Заполнить(ВыборкаТовары);
				ОбластьТовары.Параметры.НоменклатураНаименование = ОбщийМодульТекстСервер.ПолучитьОбщееНаименование(ВыборкаТовары.Номенклатура);
				ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьТовары);
				ТабДок.Вывести(ОбластьТовары, ВыборкаТовары.Уровень());
			КонецЦикла;
			
			Подвал.Параметры.Заполнить(Выборка);
			Подвал.Параметры.Выполнен = ?(Выборка.Выполнен, ОбщийМодульПовтор.ПолучитьТекстНаЯзыке("Заказ выполнен"), "");
			Подвал.Параметры.ТекстВПодвалеДокументовПриПечати = СтруктураДополнительныПараметровМакета.ТекстВПодвалеДокументовПриПечати;
			ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(Подвал); 
			ТабДок.Вывести(Подвал);
			
			Если ОбщийМодульПовтор.ПолучитьЗначениеНастройкиИлиКонстанты("ВестиУчетЗарплатыСотрудников") Тогда
				ОбластьПодписи = Макет.ПолучитьОбласть("Подписи");
				ОбластьПодписи.Параметры.Заполнить(Выборка);
				ОбщийМодульСервисСервер.ЗаменитьСвоиЗначенияПараметровПечати(ОбластьПодписи);
				ТабДок.Вывести(ОбластьПодписи);
			КонецЕсли;
			
			ВставлятьРазделительСтраниц = Истина;
		КонецЦикла;	
	КонецЕсли;
	
КонецПроцедуры
